!function(t,a){"use strict";function e(t){let a=window;for(let e of t.split("."))if(a=a[e],void 0===a)throw"Cannot locate map factory: "+t;return a}let i={tile_layer:function(t,a){t.layer_created(new L.tileLayer(a.urlTemplate,a.options),a)},geo_json:function(t,e){a.getJSON(e.dataUrl,(function(a){t.layer_created(new L.geoJSON(a,e.options),e)}))}};class o{static initialize(t){a("div.cone_map",t).each((function(){let t=a(this);new(e(t.data("map-factory")))(t)}))}constructor(t){this.elem=t,this.id=t.attr("id"),this.layers=t.data("map-layers"),this.default_center=t.data("map-center"),this.default_zoom=t.data("map-zoom"),this.map_options=t.data("map-options"),this.control_options=t.data("map-control-options"),this.source=t.data("map-source"),this.create(),t.data("map-instance",this)}create(){this.create_map(),this.create_controls(),this.create_layers()}create_map(){this.map=L.map(this.id,this.map_options),this.map.setView(this.default_center,this.default_zoom)}create_controls(){this.map_layers=new L.control.layers([],[],this.control_options),this.map_layers.addTo(this.map)}create_layers(){for(let t of this.layers)i[t.factory](this,t)}layer_created(t,a){a.layer=t,(void 0===a.display||a.display)&&t.addTo(this.map),"base"===a.category?this.map_layers.addBaseLayer(t,a.title):"overlay"===a.category&&this.map_layers.addOverlay(t,a.title)}}a((function(){void 0!==window.ts?ts.ajax.register(o.initialize,!0):bdajax.register(o.initialize,!0)})),t.Map=o,t.layer_factories=i,t.lookup_factory=e,Object.defineProperty(t,"__esModule",{value:!0}),window.cone_maps=t}({},jQuery);
